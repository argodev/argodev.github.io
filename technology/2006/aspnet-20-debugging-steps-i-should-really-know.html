<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Rob Gillen</title><link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"><link rel="stylesheet" href="/assets/site.css"><link rel="stylesheet" href="/assets/academicons.css"></head><body><div id="wrap"><div class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Rob Gillen</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/technology">Technology</a></li><li><a href="/presentations">Presentations/Talks</a></li><li><a href="/papers">Publications/Arcticles</a></li><li><a href="/projects">Projects</a></li><li><a href="/personal">Personal</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li><!--li.dropdown--><!--  a.dropdown-toggle(href="#", data-toggle="dropdown") Dropdown <b class="caret"></b>--><!--  ul.dropdown-menu--><!--    li--><!--      a(href="#") Action--><!--    li--><!--      a(href="#") Another action--><!--    li--><!--      a(href="#") Something else here--><!--    li.divider--><!--    li.dropdown-header Nav header--><!--    li--><!--      a(href="#") Separated link--><!--    li--><!--      a(href="#") One more separated link--></ul></div></div></div><div class="container"><div class="page-header"><h1>ASP.NET 2.0 Debugging steps I should really know</h1></div><div class="row"><div class="col-md-9"><div class="panel"><div class="panel-body"><div class="row"><div class="col-md-12"><h5>November 8, 2006</h5><p>As part of my &quot;not-my-real-job&quot; time, I do a little website hosting - basically to keep my hands dirty with the problem
space and to increase my visibility into the windows hosting space. One of the sites we host updated their site this
past week with a new CMS platform and the site failed to work. On the site owners development machine the site worked
fine... on my dev/test machine the site worked fine but on the production server it failed every time.</p>
<p>On the production server, we kept getting the following error:</p>
<pre><code>A process serving application pool &#39;PublishTruth&#39; suffered a fatal communication error with the
World Wide Web Publishing Service. The process id was &#39;3496&#39;. The data field contains the error
number.
</code></pre><p>After which the application pool would shut down in an effort to protect IIS from a faulty app (actually, it would shut
down after a few attempts in a short period of time).</p>
<p>This began a lesson in advanced (well, maybe not terribly so) .NET debugging. We installed the IIS Debug tools and
learned quite a bit about debug dumps and the tools and analysis options available to you at that level, but we still
weren&#39;t learning anything... the errors were coming from standard .NET assemblies.</p>
<p>The &quot;break&quot; came when a colleague came across an article (<a href="http://blogs.msdn.com/tess/archive/2006/04/27/584927.aspx">http://blogs.msdn.com/tess/archive/2006/04/27/584927.aspx</a>)
on <a href="http://blogs.msdn.com/tess">Tess Ferrandez&#39;s blog</a>. The kicker was the explanation of a substantial change between
ASP.NET 1.0/1.1 and 2.0 as <a href="http://support.microsoft.com/?id=911816">described here</a>. The net-net is that in .NET 1.0
and 1.1, unhandled exceptions on managed threads were ignored. Unless you attached a debugger to catch the exception,
you would not realize that anything was wrong. However, in .NET 2.0, when an unhandled exception in a managed thread
occurs, the <strong>asp.net application unexpectedly quits</strong>.</p>
<p>I suppose that this is a good thing, in that I would likely have not found the problem without this &quot;feature&quot;,
however it can be frustrating if you have no good way to see the actual error that is occurring. Thankfully, the <a href="http://support.microsoft.com/?id=911816">MSDN
post</a> has a sample handler module that you can implement to catch such
exceptions and log them and the stack to the event log. After implementing the sample code (specifically a copy-paste
from the article... I didn&#39;t have to change anything) I was able to see the error in the event log and quickly rectify
the problem.</p>
<p>I now have a handy little handler module that I&#39;ll keep in my toolbox as a quick way to debug such problems combined
with the knowledge of what is likely going on when my asp.net applications unexpectedly quit.</p><!--a(href='#{ conf.web_link }') Conference Homepage--><!--each session in conf.sessions--><!--  .row--><!--    .col-xs-11--><!--      h4 #{ session.title }--><!--      p #{ session.abstract }--><!--      if session.assets--><!--        ul--><!--          each asset in session.assets--><!--            li--><!--              a(href='#{ asset.link }') #{ asset.title }--></div></div><hr><div id="disqus_thread"></div></div></div></div><div class="col-sm-3"><div class="panel panel-default"><div class="panel-heading">Recent Posts</div><div class="panel-body"><ul><li><a href="/technology/2014/you-cant-handle-the-truth">You Can't Handle The Truth</a></li><li><a href="/technology/2014/codestock-2014">CodeStock 2014</a></li><li><a href="/technology/2014/tracking-planes-on-vacation">Tracking Planes on Vacation</a></li><li><a href="/technology/2014/book-review-learning-windows-mobile-services-for-win-8-and-win-phone-8">Book Review: Learning Windows Mobile Services for Win 8 and Win Phone 8</a></li><li><a href="/technology/2014/codemash-2014">CodeMash 2014</a></li></ul></div></div><div class="panel panel-default"><div class="panel-heading">Older Posts</div><div class="panel-body"><ul><li><a href="/technology/2014/">2014 Posts</a></li><li><a href="/technology/2013/">2013 Posts</a></li><li><a href="/technology/2012/">2012 Posts</a></li><li><a href="/technology/2011/">2011 Posts</a></li><li><a href="/technology/2010/">2010 Posts</a></li><li><a href="/technology/2009/">2009 Posts</a></li><li><a href="/technology/2008/">2008 Posts</a></li><li><a href="/technology/2007/">2007 Posts</a></li><li><a href="/technology/2006/">2006 Posts</a></li><li><a href="/technology/2005/">2005 Posts</a></li><li><a href="/technology/2004/">2004 Posts</a></li></ul></div></div></div></div></div></div><div id="footer"><div class="container"><p class="text-muted credit"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a> This work is licensed under a<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"> Creative Commons Attribution 4.0 International License</a>.</p></div></div><script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script><script type="text/javascript" src="/assets/site.js"></script></body></html>